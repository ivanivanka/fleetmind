<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Analytics - FleetMind AI</title>
    <link rel="stylesheet" href="/static/platform/platform.css">
</head>
<body>
    <div class="platform-layout">
        <nav class="platform-sidebar">
            <div class="sidebar-logo">
                <div class="logo-mark">
                    <svg viewBox="0 0 32 32" fill="none"><rect x="2" y="2" width="28" height="28" rx="6" stroke="#00cc44" stroke-width="2"/><circle cx="11" cy="13" r="3" fill="#00cc44"/><circle cx="21" cy="13" r="3" fill="#00cc44" opacity="0.6"/><circle cx="16" cy="22" r="3" fill="#00cc44" opacity="0.3"/><line x1="11" y1="13" x2="21" y2="13" stroke="#00cc44" stroke-width="1" opacity="0.4"/><line x1="11" y1="13" x2="16" y2="22" stroke="#00cc44" stroke-width="1" opacity="0.4"/><line x1="21" y1="13" x2="16" y2="22" stroke="#00cc44" stroke-width="1" opacity="0.4"/></svg>
                    <span>Fleet<span class="logo-accent">Mind</span></span>
                </div>
                <div class="logo-sub">Operations Platform</div>
            </div>
            <div class="sidebar-nav">
                <div class="nav-section"><div class="nav-section-label">Overview</div><a href="/platform/dashboard" class="nav-item"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="7" height="7" rx="1"/><rect x="14" y="3" width="7" height="7" rx="1"/><rect x="3" y="14" width="7" height="7" rx="1"/><rect x="14" y="14" width="7" height="7" rx="1"/></svg>Dashboard</a><a href="/" class="nav-item" target="_blank"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="3"/><path d="M12 1v4M12 19v4M4.22 4.22l2.83 2.83M16.95 16.95l2.83 2.83M1 12h4M19 12h4"/></svg>Live Fleet View</a></div>
                <div class="nav-section"><div class="nav-section-label">Management</div><a href="/platform/fleet" class="nav-item"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="2" y="6" width="20" height="12" rx="2"/><circle cx="8" cy="18" r="2"/><circle cx="16" cy="18" r="2"/><path d="M2 12h20"/></svg>Fleet</a><a href="/platform/warehouses" class="nav-item"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M3 21V8l9-5 9 5v13"/><path d="M9 21V14h6v7"/></svg>Warehouses</a></div>
                <div class="nav-section"><div class="nav-section-label">Intelligence</div><a href="/platform/analytics" class="nav-item active"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M18 20V10M12 20V4M6 20v-6"/></svg>Analytics</a><a href="/platform/insights" class="nav-item"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 2a7 7 0 0 1 7 7c0 2.38-1.19 4.47-3 5.74V17a1 1 0 0 1-1 1H9a1 1 0 0 1-1-1v-2.26C6.19 13.47 5 11.38 5 9a7 7 0 0 1 7-7z"/><path d="M9 21h6"/></svg>AI Insights<span class="badge">3</span></a></div>
                <div class="nav-section"><div class="nav-section-label">System</div><a href="/platform/settings" class="nav-item"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="3"/><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 1 1-2.83 2.83l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-4 0v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 1 1-2.83-2.83l.06-.06A1.65 1.65 0 0 0 4.68 15a1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1 0-4h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 1 1 2.83-2.83l.06.06A1.65 1.65 0 0 0 9 4.68a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 4 0v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 1 1 2.83 2.83l-.06.06A1.65 1.65 0 0 0 19.4 9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 0 4h-.09a1.65 1.65 0 0 0-1.51 1z"/></svg>Settings</a></div>
            </div>
            <div class="sidebar-footer"><div class="sidebar-user"><div class="user-avatar">II</div><div class="user-info"><div class="user-name">Ivan Ivanka</div><div class="user-role">Admin</div></div></div></div>
        </nav>

        <main class="platform-main">
            <div class="page-header">
                <div class="page-header-actions">
                    <div>
                        <h1>Analytics</h1>
                        <div class="page-subtitle">Historical performance data &middot; 6-month trend analysis</div>
                    </div>
                    <div style="display: flex; gap: 12px; align-items: center;">
                        <div class="date-range">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="4" width="18" height="18" rx="2"/><path d="M16 2v4M8 2v4M3 10h18"/></svg>
                            Aug 2025 - Feb 2026
                        </div>
                        <button class="btn" onclick="void(0)">
                            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" y1="15" x2="12" y2="3"/></svg>
                            Export CSV
                        </button>
                    </div>
                </div>
            </div>

            <div class="page-content">
                <!-- Key Metrics -->
                <div class="overview-cards">
                    <div class="overview-card">
                        <div class="card-label">Avg Picks / Hour</div>
                        <div class="card-value green">142</div>
                        <div class="card-trend up">+59.6% from 89 (Aug '25)</div>
                    </div>
                    <div class="overview-card">
                        <div class="card-label">Cost Per Pick</div>
                        <div class="card-value green">$0.14</div>
                        <div class="card-trend up">-75.9% from $0.58 (Aug '25)</div>
                    </div>
                    <div class="overview-card">
                        <div class="card-label">Fleet Utilization</div>
                        <div class="card-value blue">84%</div>
                        <div class="card-trend up">+22pp from 62% (Aug '25)</div>
                    </div>
                    <div class="overview-card">
                        <div class="card-label">Error Rate</div>
                        <div class="card-value green">0.3%</div>
                        <div class="card-trend up">-85.7% from 2.1% (Aug '25)</div>
                    </div>
                </div>

                <!-- Throughput Chart -->
                <div class="section-panel">
                    <div class="panel-header">
                        <h2>Throughput Over Time (Picks/Hour)</h2>
                        <div style="display: flex; gap: 16px; font-size: 11px;">
                            <span style="display: flex; align-items: center; gap: 4px;"><span style="width: 12px; height: 3px; background: #00cc44; border-radius: 2px; display: inline-block;"></span> Actual</span>
                            <span style="display: flex; align-items: center; gap: 4px;"><span style="width: 12px; height: 3px; background: #3388ff; border-radius: 2px; display: inline-block;"></span> Target</span>
                        </div>
                    </div>
                    <div class="panel-body">
                        <div class="chart-container" style="height: 280px;">
                            <canvas id="chart-throughput" style="width: 100%; height: 280px;"></canvas>
                        </div>
                    </div>
                </div>

                <!-- Tasks Per Week Bar Chart -->
                <div class="section-panel">
                    <div class="panel-header">
                        <h2>Tasks Completed Per Week</h2>
                    </div>
                    <div class="panel-body">
                        <div class="chart-container" style="height: 240px;">
                            <canvas id="chart-tasks-week" style="width: 100%; height: 240px;"></canvas>
                        </div>
                    </div>
                </div>

                <!-- Detailed Metrics Trend -->
                <div class="grid-2">
                    <div class="section-panel">
                        <div class="panel-header"><h2>Cost Per Pick Trend</h2></div>
                        <div class="panel-body">
                            <div class="chart-container" style="height: 200px;">
                                <canvas id="chart-cost" style="width: 100%; height: 200px;"></canvas>
                            </div>
                        </div>
                    </div>
                    <div class="section-panel">
                        <div class="panel-header"><h2>Error Rate Trend</h2></div>
                        <div class="panel-body">
                            <div class="chart-container" style="height: 200px;">
                                <canvas id="chart-errors" style="width: 100%; height: 200px;"></canvas>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Fleet Utilization -->
                <div class="section-panel">
                    <div class="panel-header"><h2>Fleet Utilization Over Time</h2></div>
                    <div class="panel-body">
                        <div class="chart-container" style="height: 220px;">
                            <canvas id="chart-utilization" style="width: 100%; height: 220px;"></canvas>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <script src="/static/platform/platform.js"></script>
    <script>
        // 9 months of monthly labels: Jun 2025 - Feb 2026
        const months = ['Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec', 'Jan', 'Feb'];

        // Throughput: gradual improvement
        const throughputActual = [72, 78, 89, 97, 108, 118, 126, 134, 142];
        const throughputTarget = [80, 90, 100, 110, 120, 125, 130, 135, 140];

        drawLineChart('chart-throughput', [
            { data: throughputActual, color: '#00cc44', fill: true },
            { data: throughputTarget, color: '#3388ff', fill: false }
        ], months, { yMin: 50, yMax: 160, yFormat: v => v.toFixed(0) });

        // Tasks per week (26 weeks ~ Aug to Feb)
        const weekLabels = [];
        const weekData = [];
        const baseDate = new Date(2025, 7, 4); // Aug 4 2025
        for (let i = 0; i < 28; i++) {
            const d = new Date(baseDate);
            d.setDate(d.getDate() + i * 7);
            weekLabels.push((d.getMonth()+1) + '/' + d.getDate());
            // Gradual increase with some noise
            const base = 4200 + i * 140;
            const noise = Math.sin(i * 0.7) * 300 + Math.cos(i * 1.3) * 200;
            weekData.push(Math.round(base + noise));
        }

        drawBarChart('chart-tasks-week', weekData, weekLabels, '#00cc44');

        // Cost per pick
        const costData = [0.58, 0.52, 0.45, 0.38, 0.32, 0.26, 0.22, 0.18, 0.14];
        drawLineChart('chart-cost', [
            { data: costData, color: '#ffaa00', fill: true }
        ], months, { yMin: 0, yMax: 0.7, yFormat: v => '$' + v.toFixed(2) });

        // Error rate
        const errorData = [2.1, 1.9, 1.6, 1.3, 1.0, 0.7, 0.5, 0.4, 0.3];
        drawLineChart('chart-errors', [
            { data: errorData, color: '#ff3344', fill: true }
        ], months, { yMin: 0, yMax: 2.5, yFormat: v => v.toFixed(1) + '%' });

        // Fleet utilization
        const utilData = [55, 58, 62, 67, 71, 74, 78, 81, 84];
        drawLineChart('chart-utilization', [
            { data: utilData, color: '#3388ff', fill: true }
        ], months, { yMin: 40, yMax: 100, yFormat: v => v.toFixed(0) + '%' });
    </script>
</body>
</html>
